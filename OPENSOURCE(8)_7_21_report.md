# 오픈소스 시스템 설계서

## < 전자 제품 중고거래 사이트 - 검색 및 추천을 통해 유저에게 제공 >

- 검색 엔진 및 추천 서비스

| 프로젝트 이름  |                                                        |
| -------------- | ------------------------------------------------------ |
| 참여자         | 김택신, 남기철, 민찬혁, 박광수, 최어진, 허서준, 황선하 |
| 날짜           |                                                        |
| Classification | Public                                                 |

## 서비스 소개

Pull Request Test

## 유사 서비스 분석



## 시스템 설계 내용 요약

- 사용된 오픈소스 목록
  - < 로그인 오픈소스 >
    - 간단한 설명
  - MySQL - 허서준
    - 간단한 설명
  - < 오타 수정 오픈소스 >
    - 간단한 설명
  - < 검색 엔진 오픈소스 >
    - 간단한 설명
  - Apache PredictionIO: 사용자 추천 오픈소스
    - 오픈소스 설명: 개발자와 데이터 과학자가 기계 학습 작업을 위한 예측 엔진을 만들 수 있도록 최신 오픈소스 스택 위에 구축된 **오픈소스 기계 학습 서버입니다.**
    - 깃허브 링크: https://github.com/apache/predictionio.git
    - [Apache License 2.0](https://github.com/apache/predictionio/blob/develop/LICENSE.txt)
  - < 데이터 시각화 오픈소스 >
    - 간단한 설명
  - < 이미지 크롤링 오픈소스 >
    - 간단한 설명

## 사용된 오픈소스에 대한 설명

- ### < 로그인 오픈소스 >

  - 설명:

- ### < DB 관리 오픈소스 >

  - 설명:

- ### < 오타 수정 오픈소스 >

  - 설명:

- ### < 검색 엔진 오픈소스 >

  - 설명:

- ### Apache PredictionIO: 사용자 추천 오픈소스

  - 개발자와 데이터 과학자가 기계 학습 작업을 위한 예측 엔진을 만들 수 있도록 최신 오픈소스 스택 위에 구축된 **오픈소스 기계 학습 서버입니다.**

  - #### PredictionIO로 수행 가능한 목록

    - Customizable templates를 사용해 프로덕션 환경에서 엔진을 웹 서비스로 신속하게 구축하고 배포할 수 있습니다.
      - Customizable templates(엔진 템플릿 다운로드가 필요)
        - Universal 추천기: 전자 상거래, 뉴스, 비디오, 사용자 행동 데이터가 알려진 모든 곳에서 권장 사항을 요구하는 고의 모든 경우
        - **추천**: 저희 서비스가 사용할 엔진 템플릿입니다. 해당 템플릿에는 기본적으로 Apache Spark MLlib의 협업 필터링 알고리즘이 통합되어 있습니다. 특정 요구사항에 맞게 쉽게 사용자 정의가 가능합니다.
        - 전자상거래 추천
        - 유사한 제품 추천
    - 웹 서비스로 배포 시에 동적 Query에 **실시간으로 응답합니다.**
      - Query: 데이터베이스에게 특정 데이터를 보여달라는 클라이언트(사용자)의 요구
    - 여러 엔진의 변형을 체계적으로 평가하고 조정합니다.
      - 엔진: 예측을 담당하는 기관으로, 훈련 데이터를 읽고 예측 모델 구축 후 웹 서비스로 배포합니다.
    - 포괄적인 예측 분석을 위해 여러 플랫폼의 데이터를 일괄 혹은 실시간으로 통합합니다.
    - 자체 기계학습 모델을 구현하고 이를 엔진에 원활하게 통합합니다.
    - 체계적인 프로세스와 사전 구축된 평가 조치를 통해 머신러닝 모델링 속도를 향상합니다.

  - #### 구성

    - PredictionIO 플랫폼: 머신러닝 알고리즘으로 엔진 구축, 엔진에 대한 평가와 구축된 엔진을 배포하기 위한 머신러닝 스택입니다.

    - 이벤트 서버: 여러 플랫폼의 이벤트를 통합하기 위한 오픈소스 머신러닝 분석 계층입니다. 어플리케이션에서 지속적으로 데이터를 수집합니다.

    - 템플릿 갤러리: 다양한 유형의 기계학습 어플리케이션에 대한 엔진 템플릿을 다운로드할 수 있습니다.

    - 엔진 배포 방법

      1. PredictionIO 설치 및 실행

      2. 엔진 템플릿을 다운로드하여 엔진 생성

         - 템플릿 갤러리로 이동하여 엔진 템플릿을 선택하고 해당 이름을 클릭
         - 클릭 시, GitHub 리포지토리로 리다이렉션됩니다.
         - 엔진을 로컬 컴퓨터에 Clone하여 추가로 사용 지정합니다.

      3. PredictionIO를 새 어플리케이션과 통합하는 경우, 앱 ID 및 액세스 키 생성

      4. 데이터 수집

      5. 엔진을 서비스로 배포: 해당 단계에서 엔진은 **충분한 훈련**이 되어 있어야 합니다.

         1. ```pio app new **어플이름**```을 실행하고 다운받은 템플릿의 engine.json파일 안에 ```appName```을 지정합니다. (여기에서 원하는대로 설정 가능)
         2. ```pio build```를 실행하여 엔진을 업데이트합니다.
         3. 교육 데이터로 예측 모델을 교육하기 위해 ```pio train```을 실행합니다.
         4. ```pio deploy```를 실행해 엔진을 서비스로 배포합니다.

         - 배포된 엔진은 기본적으로 포트 번호 8000을 수신합니다.
         - 어플리케이션은 REST 인터페이스를 통해 실시간으로 예측을 검색하는 쿼리를 보냅니다.

      6. 엔진 사용

  - #### 설치와 시스템 아키텍처 및 종속성

    - 템플릿은 일반적으로 백그라운드의 주기적인 모델 업데이트와 실시간 제공을 통합하기 위한 Lambda 모델에 적합합니다.

    - PredictionIO를 지원하는 기술이 최소버전을 충족하고 있는지 확인이 **반드시 필요**합니다.

    - 이벤트 서버 데이터 저장소: Apache HBase -> 가져온 이벤트 저장

      - Apache Hadoop 2.6.5(선택사항)
      - Haoop 2.6용 Apache Spark 2.0.2: 데이터 준비 및 알고맂즘에 대한 입력, 훈련, 서빙처리를 지원하는 데이터 처리 엔진
        - HDFS: 분산 파일 시스템입니다. 클러스터된 시스템 간에 저장소를 공유할 수 있습니다. 데이터 일괄 가져오기, 이벤트 서버 데이터 세트 내보내기 및 일부 모델 저장을 위해 데이터를 준비하는 데에 사용합니다.
      - 자바 Se 개발 키트 8
      - **MySQL 5.1**
      - **Elastic Search 1.7.6**: 모델 버전, 엔진 버전, 액세스 키 및 앱 ID 매핑, 평가 결과 등과 같은 메타데이터를 저장합니다. 일부 템플릿의 경우 모델을 저장할 수 있습니다.

      학습 결과는 모델과 해당 메타데이터의 두 부분으로 구성됩니다. 그런 다음 모델은 HDFS와 로컬 파일 시스템 혹은 Elasticsearch에 저장됩니다.

  - #### 앱 통합

    - 프로덕션 환경의 애플리케이션과 통합되는 기계 학습 서버로 설계되었습니다.

      1. 모델 교육을 위해 Apache PredictionIO의 이벤트 서버로 이벤트 데이터를 보냅니다.
      2. 배포된 엔진에 동적 쿼리를 보내 예측 결과를 검색합니다.

    - 이벤트 데이터 보내기

      - 이벤트 서버는 어플리케이션에서 이벤트 데이터를 수신합니다. 이 데이터는 엔진에서 예측 모델을 구축하기 위한 학습 데이터로 사용이 가능합니다.

      - 이벤트 서버는 기본적으로 포트 번호로 7070을 사용하지만 이벤트 서버를 시작할 때 ``` --port```인수로 포트를 변경할 수 있습니다.

      - 이벤트 서버

        - RESTful API를 통해 이벤트 기반 스타일로 데이터를 수집하는 이벤트 서버를 제공합니다.

        - 기본적으로 Event Server는 Apache HBase를 데이터 저장소로 사용합니다.

        - 예시) 상품 추천을 위해 수집할 이벤트 예시

          - 사용자 1이 구매한 제품 X
          - 사용자 2가 조회한 제품 Y
          - 사용자 1이 장바구니에 추가한 제품 Z

          이 때, 사용자 Property는 성별, 나이, 위치 등일 수 있습니다.

          제품 Property는 장르, 작성자 및 사용자의 선호도와 관련될 수 있습니다.

    - 쿼리 보내기

      - 엔진을 웹 서비스로 배포하면 어플리케이션의 쿼리를 기다리고 예상 결과를 **JSON**형식으로 반환합니다. 엔진은 기본적으로 포트 8000을 수신합니다.

  - #### 파이썬 SDK

    - 설치

      - PyPI에서 모듈 설치

      ```
      $ pip install predictionio
      혹은
      $ easy_install predictionio
      ```

      - 리포지토리를 Clone한 뒤 직접 설치 - Python 환경에 predictionio 모듈 설치

      ```
      $ python setup.py install
      ```

      - 파이썬 스크립트에서 PredictionIO를 사용

      ```py
      >>> import prediction
      ```

  - #### 추천

    - 이벤트 데이터 요구사항: 기본적으로 템플릿에서는 사용자가 평가한 항목 이벤트와 사용자가 구매한 항목 이벤트가 필요합니다.
    - 입력 쿼리: 사용자 아이디와 추천할 아이템의 수
    - 출력 예측 결과: 권장 항목 ID의 순위 목록

    1. MySQL을 사용하는 경우 ```$ pio eventserver &```을 실행해 이벤트 서버를 실행합니다.

       - 정상 실행된 경우 다음 코드 블럭이 실행됩니다.

         ```
         ...
         
         (sleeping 5 seconds for all messages to show up...)
         Your system is all ready to go.
         ```

    2. 엔진 템플릿에서 사용할 엔진을 디렉터리로 clone하여 다음 명령을 실행합니다.

       ```
       $ 자식 클론 https://github.com/apache/predictionio-template-recommender.git MyRecommendation
       $ cd MyRecommendation
       ```

    3. 앱 ID 및 액세스 키를 생성합니다.

    4. 데이터를 수집합니다.

       - 데이터 인풋으로 지정한 평가 및 구매 항목에 대한 이벤트를 이벤트 서버에 실시간으로 쉽게 보낼 수 있습니다.

         ```
         $ curl -i -X GET " http://localhost:7070/events.json?accessKey= $ACCESS_KEY "
         ```

       - 이 때 가져오는 이벤트는 JSON 파일로 변환합니다.

       - 해당 메서드는 PredictionIO의 함수로서 지정되어 있습니다.

    5. 엔진을 서비스로 배포합니다.

- ### < 데이터 시각화 오픈소스 >

  - 설명:

- ### < 이미지 크롤링 오픈소스 >

  - 설명:

## DFD